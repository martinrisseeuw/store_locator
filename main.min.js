"use strict";function queryElementHeight(e){var t=document.querySelector(e).offsetHeight;return t}function getLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(showPosition):alert("Geolocation is not supported by this browser.")}function showPosition(e){alert("Latitude: "+e.coords.latitude+"Longitude: "+e.coords.longitude)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function e(t,n,i){function o(r,a){if(!n[r]){if(!t[r]){var c="function"==typeof require&&require;if(!a&&c)return c(r,!0);if(s)return s(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[r]={exports:{}};t[r][0].call(u.exports,function(e){var n=t[r][1][e];return o(n?n:e)},u,u.exports,e,t,n,i)}return n[r].exports}for(var s="function"==typeof require&&require,r=0;r<i.length;r++)o(i[r]);return o}({1:[function(e,t,n){function i(e){this._ev=new a,this.options=r({},this.options,e)}if(!mapboxgl)throw new Error("include mapboxgl before mapbox-gl-geocoder.js");var o=e("suggestions"),s=e("lodash.debounce"),r=e("xtend"),a=e("events").EventEmitter,c="https://api.mapbox.com/geocoding/v5/mapbox.places/";i.prototype=mapboxgl.util.inherit(mapboxgl.Control,{options:{position:"top-left",placeholder:"Adres, plaats, land.",zoom:16,flyTo:!0},onAdd:function(e){this.request=new XMLHttpRequest,this.container=this.options.container?"string"==typeof this.options.container?document.getElementById(this.options.container):this.options.container:e.getContainer();var t=document.createElement("div");t.className="mapboxgl-ctrl-geocoder";var n=document.createElement("span");n.className="geocoder-icon geocoder-icon-search";var i=this._inputEl=document.createElement("input");i.type="text",i.placeholder=this.options.placeholder,i.addEventListener("keydown",s(function(e){return e.target.value?void(e.metaKey||[9,27,37,39,13,38,40].indexOf(e.keyCode)!==-1||this._queryFromInput(e.target.value)):this._clearEl.classList.remove("active")}.bind(this)),200),i.addEventListener("change",function(t){t.target.value&&this._clearEl.classList.add("active");var n=this._typeahead.selected;if(n){if(this.options.flyTo)if(n.bbox&&n.context&&n.context.length<=3||n.bbox&&!n.context){var i=n.bbox;e.fitBounds([[i[0],i[1]],[i[2],i[3]]])}else e.flyTo({center:n.center,zoom:this.options.zoom,speed:.5});this._input=n,this.fire("result",{result:n})}}.bind(this));var r=document.createElement("div");r.classList.add("geocoder-pin-right");var a=this._clearEl=document.createElement("button");a.className="geocoder-icon geocoder-icon-close",a.addEventListener("click",this._clear.bind(this));var c=this._loadingEl=document.createElement("span");return c.className="geocoder-icon geocoder-icon-loading",r.appendChild(a),r.appendChild(c),t.appendChild(n),t.appendChild(i),t.appendChild(r),this.container.appendChild(t),this.options.container&&(this.options.position=!1),this._typeahead=new o(i,[],{filter:!1}),this._typeahead.getItemValue=function(e){return e.place_name},t},_geocode:function(e,t){this._loadingEl.classList.add("active"),this.fire("loading");var n=[];this.options.proximity&&n.push("proximity="+this.options.proximity.join()),this.options.bbox&&n.push("bbox="+this.options.bbox.join()),this.options.country&&n.push("country="+this.options.country),this.options.types&&n.push("types="+this.options.types);var i=this.options.accessToken?this.options.accessToken:mapboxgl.accessToken;n.push("access_token="+i),this.request.abort(),this.request.open("GET",c+encodeURIComponent(e.trim())+".json?"+n.join("&"),!0),this.request.onload=function(){if(this._loadingEl.classList.remove("active"),this.request.status>=200&&this.request.status<400){var e=JSON.parse(this.request.responseText);return e.features.length?this._clearEl.classList.add("active"):(this._clearEl.classList.remove("active"),this._typeahead.selected=null),this.fire("results",{results:e.features}),this._typeahead.update(e.features),t(e.features)}this.fire("error",{error:JSON.parse(this.request.responseText).message})}.bind(this),this.request.onerror=function(){this._loadingEl.classList.remove("active"),this.fire("error",{error:JSON.parse(this.request.responseText).message})}.bind(this),this.request.send()},_queryFromInput:function(e){e=e.trim(),e||this._clear(),e.length>2&&this._geocode(e,function(e){this._results=e}.bind(this))},_change:function(){var e=document.createEvent("HTMLEvents");e.initEvent("change",!0,!1),this._inputEl.dispatchEvent(e)},_query:function(e){e&&("object"==("undefined"==typeof e?"undefined":_typeof(e))&&e.length&&(e=[mapboxgl.util.wrap(e[0],-180,180),mapboxgl.util.wrap(e[1],-180,180)].join()),this._geocode(e,function(e){if(e.length){var t=e[0];this._results=e,this._typeahead.selected=t,this._inputEl.value=t.place_name,this._change()}}.bind(this)))},_setInput:function(e){e&&("object"==("undefined"==typeof e?"undefined":_typeof(e))&&e.length&&(e=[mapboxgl.util.wrap(e[0],-180,180),mapboxgl.util.wrap(e[1],-180,180)].join()),this._inputEl.value=e,this._input=null,this._typeahead.selected=null,this._typeahead.clear(),this._change())},_clear:function(){this._input=null,this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._change(),this._inputEl.focus(),this._clearEl.classList.remove("active"),this.fire("clear")},getResult:function(){return this._input},query:function(e){return this._query(e),this},setInput:function(e){return this._setInput(e),this},on:function(e,t){return this._ev.on(e,t),this},fire:function(e,t){return this._ev.emit(e,t),this},off:function(e,t){return this._ev.removeListener(e,t),this}}),window.mapboxgl?mapboxgl.Geocoder=i:"undefined"!=typeof t&&(t.exports=i)},{events:2,"lodash.debounce":4,suggestions:5,xtend:8}],2:[function(e,t,n){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(e){return"function"==typeof e}function s(e){return"number"==typeof e}function r(e){return"object"==("undefined"==typeof e?"undefined":_typeof(e))&&null!==e}function a(e){return void 0===e}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!s(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,n,i,s,c,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}if(n=this._events[e],a(n))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(r(n))for(s=Array.prototype.slice.call(arguments,1),l=n.slice(),i=l.length,c=0;c<i;c++)l[c].apply(this,s);return!0},i.prototype.addListener=function(e,t){var n;if(!o(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,o(t.listener)?t.listener:t),this._events[e]?r(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,r(this._events[e])&&!this._events[e].warned&&(n=a(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!o(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},i.prototype.removeListener=function(e,t){var n,i,s,a;if(!o(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],s=n.length,i=-1,n===t||o(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(r(n)){for(a=s;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){i=a;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],o(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?o(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(o(t))return 1;if(t)return t.length}return 0},i.listenerCount=function(e,t){return e.listenerCount(t)}},{}],3:[function(e,t,n){!function(){var e=this,i={};"undefined"!=typeof n?t.exports=i:e.fuzzy=i,i.simpleFilter=function(e,t){return t.filter(function(t){return i.test(e,t)})},i.test=function(e,t){return null!==i.match(e,t)},i.match=function(e,t,n){n=n||{};var i,o=0,s=[],r=t.length,a=0,c=0,l=n.pre||"",u=n.post||"",h=n.caseSensitive&&t||t.toLowerCase();e=n.caseSensitive&&e||e.toLowerCase();for(var p=0;p<r;p++)i=t[p],h[p]===e[o]?(i=l+i+u,o+=1,c+=1+c):c=0,a+=c,s[s.length]=i;return o===e.length?{rendered:s.join(""),score:a}:null},i.filter=function(e,t,n){return n=n||{},t.reduce(function(t,o,s,r){var a=o;n.extract&&(a=n.extract(o));var c=i.match(e,a,n);return null!=c&&(t[t.length]={string:c.rendered,score:c.score,index:s,original:o}),t},[]).sort(function(e,t){var n=t.score-e.score;return n?n:e.index-t.index})}}()},{}],4:[function(e,t,n){function i(e,t,n){function i(t){var n=v,i=m;return v=m=void 0,E=t,g=e.apply(i,n)}function o(e){return E=e,_=setTimeout(u,t),C?i(e):g}function r(e){var n=e-b,i=e-E,o=t-n;return T?L(o,y-i):o}function a(e){var n=e-b,i=e-E;return!b||n>=t||n<0||T&&i>=y}function u(){var e=w();return a(e)?h(e):void(_=setTimeout(u,r(e)))}function h(e){return clearTimeout(_),_=void 0,q&&v?i(e):(v=m=void 0,g)}function p(){void 0!==_&&clearTimeout(_),b=E=0,v=m=_=void 0}function d(){return void 0===_?g:h(w())}function f(){var e=w(),n=a(e);if(v=arguments,m=this,b=e,n){if(void 0===_)return o(b);if(T)return clearTimeout(_),_=setTimeout(u,t),i(b)}return void 0===_&&(_=setTimeout(u,t)),g}var v,m,y,g,_,b=0,E=0,C=!1,T=!1,q=!0;if("function"!=typeof e)throw new TypeError(l);return t=c(t)||0,s(n)&&(C=!!n.leading,T="maxWait"in n,y=T?x(c(n.maxWait)||0,t):y,q="trailing"in n?!!n.trailing:q),f.cancel=p,f.flush=d,f}function o(e){var t=s(e)?b.call(e):"";return t==h||t==p}function s(e){var t="undefined"==typeof e?"undefined":_typeof(e);return!!e&&("object"==t||"function"==t)}function r(e){return!!e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))}function a(e){return"symbol"==("undefined"==typeof e?"undefined":_typeof(e))||r(e)&&b.call(e)==d}function c(e){if("number"==typeof e)return e;if(a(e))return u;if(s(e)){var t=o(e.valueOf)?e.valueOf():e;e=s(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(f,"");var n=m.test(e);return n||y.test(e)?g(e.slice(2),n?2:8):v.test(e)?u:+e}var l="Expected a function",u=NaN,h="[object Function]",p="[object GeneratorFunction]",d="[object Symbol]",f=/^\s+|\s+$/g,v=/^[-+]0x[0-9a-f]+$/i,m=/^0b[01]+$/i,y=/^0o[0-7]+$/i,g=parseInt,_=Object.prototype,b=_.toString,x=Math.max,L=Math.min,w=Date.now;t.exports=i},{}],5:[function(e,t,n){var i=e("./src/suggestions");window.Suggestions=t.exports=i},{"./src/suggestions":7}],6:[function(e,t,n){"Use strict";var i=function(e){return this.component=e,this.items=[],this.active=0,this.element=document.createElement("ul"),this.element.className="suggestions",e.el.parentNode.insertBefore(this.element,e.el.nextSibling),this};i.prototype.show=function(){this.element.style.display="block"},i.prototype.hide=function(){this.element.style.display="none"},i.prototype.add=function(e){this.items.push(e)},i.prototype.clear=function(){this.items=[],this.active=0},i.prototype.isEmpty=function(){return!this.items.length},i.prototype.draw=function(){if(this.element.innerHTML="",0===this.items.length)return void this.hide();for(var e=0;e<this.items.length;e++)this.drawItem(this.items[e],this.active===e);this.show()},i.prototype.drawItem=function(e,t){var n=document.createElement("li"),i=document.createElement("a");t&&(n.className+=" active"),i.innerHTML=e.string,n.appendChild(i),this.element.appendChild(n),n.addEventListener("mousedown",function(){this.handleMouseDown.call(this,e)}.bind(this))},i.prototype.handleMouseDown=function(e){this.component.value(e.original),this.clear(),this.draw()},i.prototype.move=function(e){this.active=e,this.draw()},i.prototype.previous=function(){this.move(0===this.active?this.items.length-1:this.active-1)},i.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)},t.exports=i},{}],7:[function(e,t,n){var i=e("xtend"),o=e("fuzzy"),s=e("./list"),r=function(e,t,n){return n=n||{},this.options=i({minLength:2,limit:5,filter:!0},n),this.el=e,this.data=t||[],this.list=new s(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",function(e){this.handleKeyUp(e.keyCode)}.bind(this),!1),this.el.addEventListener("keydown",function(e){this.handleKeyDown(e)}.bind(this)),this.el.addEventListener("focus",function(){this.handleFocus()}.bind(this)),this.el.addEventListener("blur",function(){this.handleBlur()}.bind(this)),this};r.prototype.handleKeyUp=function(e){if(40!==e&&38!==e&&27!==e&&13!==e&&9!==e)return this.query=this.normalize(this.el.value),this.list.clear(),this.query.length<this.options.minLength?void this.list.draw():void this.getCandidates(function(e){for(var t=0;t<e.length&&(this.list.add(e[t]),t!==this.options.limit-1);t++);this.list.draw()}.bind(this))},r.prototype.handleKeyDown=function(e){switch(e.keyCode){case 13:case 9:this.list.isEmpty()||(this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next()}},r.prototype.handleBlur=function(){this.list.hide()},r.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show()},r.prototype.update=function(e){this.data=e,this.list.draw()},r.prototype.clear=function(){this.data=[],this.list.clear()},r.prototype.normalize=function(e){return e=e.toLowerCase()},r.prototype.match=function(e,t){return e.indexOf(t)>-1},r.prototype.value=function(e){if(this.selected=e,this.el.value=this.getItemValue(e),document.createEvent){var t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!1),this.el.dispatchEvent(t)}else this.el.fireEvent("onchange")},r.prototype.getCandidates=function(e){var t={pre:"<strong>",post:"</strong>",extract:function(e){return this.getItemValue(e)}.bind(this)},n=this.options.filter?o.filter(this.query,this.data,t):this.data.map(function(e){return{original:e,string:this.getItemValue(e).replace(new RegExp("("+this.query+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})}}.bind(this));e(n)},r.prototype.getItemValue=function(e){return e},t.exports=r},{"./list":6,fuzzy:3,xtend:8}],8:[function(e,t,n){function i(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var i in n)o.call(n,i)&&(e[i]=n[i])}return e}t.exports=i;var o=Object.prototype.hasOwnProperty},{}]},{},[1]),function(){function e(e){var n=document.createElement("li"),o=document.createElement("h2"),s=document.createElement("p"),r=document.createElement("p"),a=document.createElement("a"),c=document.createElement("a");a.href="https://maps.google.com?saddr=Current+Location&daddr="+e.geometry.coordinates[1]+","+e.geometry.coordinates[0],a.classList.add("route__link"),a.setAttribute("target","_blank"),a.innerHTML='<span class="route__icon"></span> Route',c.href=e.properties.website,c.classList.add("website__link"),c.setAttribute("target","_blank"),c.innerHTML='<span class="website__icon"></span> Website',r.textContent=e.properties.address,s.textContent="Tel: "+e.properties.phone,o.textContent=e.properties.name,n.appendChild(o),n.appendChild(r),e.properties.phone&&n.appendChild(s),n.appendChild(c),n.appendChild(a),n.addEventListener("click",function(n){t(e),i()}),l.insertBefore(n,l.firstChild)}function t(e){h.forEach(function(e){e._closeButton.click()}),h=[];var t=new mapboxgl.Popup;t.setLngLat(e.geometry.coordinates),t.setHTML('<div class="pop__flex">\n        <div class="main__pop">\n        <h2>'+e.properties.name+"</h2>\n        <p>"+e.properties.address+"</p>\n        "+(e.properties.phone?"<p>"+e.properties.phone+"</p>":"")+'\n      </div>\n      <div class="pop__links">\n      '+(e.properties.website?'<a class="websiteBtn" href="'+e.properties.website+'"><div><span class="website__icon"></span><span>website</span></div></a>':"")+"\n      "+(e.properties.phone?'<a class="callBtn" href="tel:'+e.properties.phone+'"><div><span class="bellen__icon"></span><span>bellen</span></div></a>':"")+'\n      <a href="https://maps.google.com?saddr=Current+Location&daddr='+e.geometry.coordinates[1]+","+e.geometry.coordinates[0]+'"><div><span class="route__icon"></span><span>route</span></div></a>\n      </div>'),window.innerWidth<1024&&a.flyTo({center:e.geometry.coordinates}),h.push(t),t.addTo(a)}function n(){function t(){function e(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=e.properties.name,i=n[t];return!i&&(n[t]=!0,!0)}var t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],n={};return t.filter(e)}l.innerHTML="";var n=document.getElementById("map").getBoundingClientRect(),i=a.getCanvasContainer(),o=i.getBoundingClientRect(),s=(a.getBounds(),[{x:0,y:0},{x:o.width,y:n.bottom}]),r=a.queryRenderedFeatures(s,{layers:["markers"]}),c=t(r);console.log("filtered features",c),c.map(function(t){e(t)})}function i(){s?s&&(document.querySelector(".storelocator__sidebar__list").classList.remove("active"),document.querySelector(".mobile__results").innerHTML="Toon resultaten in lijst <span class='down__icon'></span>",document.body.style.overflow="auto",s=!1):(document.querySelector(".storelocator__sidebar__list").classList.add("active"),document.querySelector(".mobile__results").innerHTML="Verberg lijst <span class='down__icon active'></span>",document.body.style.overflow="hidden",s=!0)}mapboxgl.accessToken="pk.eyJ1IjoibGV4aXMiLCJhIjoiUXA2MVFYSSJ9.2LIrKSEKKZtCJKxe81xf_g";var o=.8,s=!1,r=[[-180,82],[180,-82]],a=new mapboxgl.Map({container:"map",style:"mapbox://styles/lexis/ciqm41fi50009cfkvx7oyl7vt",center:[5.3770023,52.1626588],zoom:6,minZoom:2.5,pitch:25,maxBounds:r}),c=document.querySelector("#geocoder__container"),l=document.querySelector(".storelocator__sidebar__list"),u=new mapboxgl.Geocoder({flyTo:!0,zoom:16,container:c});a.addControl(u),document.querySelector(".mobile__results").addEventListener("click",i),a.on("load",function(){function e(e){var n=a.queryRenderedFeatures(e,{layers:["markers"]});if(n.length){var i=n[0];t(i)}}a.addSource("stores",{type:"geojson",data:"http://martinr.nl/all.geojson",cluster:!0,clusterMaxZoom:12,clusterRadius:95}),a.addLayer({id:"markers",type:"symbol",source:"stores",layout:{"icon-image":"marker-15","icon-size":1}});var n=[[150,"rgba(0, 0, 0, 0.8)",36],[20,"rgba(0, 0, 0, 0.7)",26],[0,"rgba(0, 0, 0, 0.6)",16]];n.forEach(function(e,t){a.addLayer({id:"cluster-"+t,type:"circle",source:"stores",paint:{"circle-color":e[1],"circle-radius":e[2]},filter:0===t?[">=","point_count",e[0]]:["all",[">=","point_count",e[0]],["<","point_count",n[t-1][0]]]})}),a.addLayer({id:"cluster-count",type:"symbol",source:"stores",paint:{"text-color":"white"},layout:{"text-field":"{point_count}","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":15}}),a.on("click",function(t){e(t.point)}),a.on("mousemove",function(e){var t=a.queryRenderedFeatures(e.point,{layers:["markers"],radius:1e3});a.getCanvas().style.cursor=t.length?"pointer":"",console.log(a.getBounds())}),a.on("click",function(e){var t=a.queryRenderedFeatures(e.point,{layers:["cluster-count"]});t.length&&a.flyTo({center:t[0].geometry.coordinates,zoom:a.getZoom()+3,speed:o}),a.fire("flystart")})});var h=[];a.on("moveend",function(){a.fire("flyend")}),a.on("flyend",function(){n()}),a.on("flystart",function(){}),a.on("zoomed",function(){n()}),a.on("load",function(){setTimeout(n,400)}),a.addControl(new mapboxgl.Navigation)}();